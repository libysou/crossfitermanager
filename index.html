<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>크로스핏 계산기</title>
<style>
:root{--bg:#0f172a;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;--text:#e6eef8}
html,body{margin:0;padding:0;height:100%;font-family:Inter,system-ui,Segoe UI,Roboto,'Noto Sans KR',sans-serif;background:linear-gradient(180deg,#071022 0%,#07182a 100%);color:var(--text)}
.app{max-width:440px;margin:12px auto;padding:12px}
header{display:flex;align-items:center;justify-content:space-between}
h1{font-size:18px;margin:0}
nav{display:flex;gap:6px;margin:12px 0;overflow:auto}
button.tab{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:var(--text);font-weight:600;white-space:nowrap}
.card{background:var(--card);padding:12px;border-radius:12px;margin-bottom:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6);display:none}
.card.active{display:block}
label{font-size:13px;color:var(--muted)}
input[type=number],input[type=text],select{width:100%;padding:10px;margin-top:6px;border-radius:10px;border:0;background:rgba(255,255,255,0.02);color:var(--text)}
.row{display:flex;gap:8px;flex-wrap:wrap}
.row > *{flex:1}
.bigbtn{width:100%;padding:12px;border-radius:12px;border:0;background:var(--accent);color:#032023;font-weight:700;font-size:16px;transition:transform 0.1s,box-shadow 0.1s;}
.bigbtn:active{transform:translateY(2px);box-shadow:0 2px 4px rgba(0,0,0,0.2);}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:6px;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:13px;text-align:center}
.small{font-size:12px;color:var(--muted)}
.pill{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;font-weight:600}
</style>
</head>
<body>
<div class="app">
<header>
<h1> 🏋️ 크로스핏 계산기 🏋️</h1>
<div class="pill small">해지메이드.문의사절.ver1</div>
</header>

<nav>
<button class="tab" data-tab="time">시간</button>
<button class="tab" data-tab="1rm">1RM</button>
<button class="tab" data-tab="rpe">RPE</button>
<button class="tab" data-tab="pace">Pace</button>
<button class="tab" data-tab="plates">플레이트</button>
</nav>

<!-- ================= 시간 계산기 ================= -->
<section id="time" class="card active">
<h2>시간 계산기</h2>
<div class="row" style="gap:6px;margin-bottom:12px;">
<label>휴식 시간 모드:</label>
<select id="restMode">
<option value="manual">수동설정</option>
<option value="ratio">1:1 Rest</option>
</select>
<input type="number" id="restTime" placeholder="휴식시간(초)" min="0" />
</div>
<div class="row" style="gap:6px;margin-bottom:12px;">
<label>세트 수:</label>
<input type="number" id="totalSets" placeholder="세트 수" min="1">
<button class="bigbtn" id="generateTable">표 생성</button>
</div>
<table id="timeTable" style="display:none">
<thead>
<tr>
<th>세트</th>
<th>운동 시작시간</th>
<th>운동 종료시간</th>
<th>세트 소요시간</th>
<th>쉬는시간</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="row" style="gap:6px;margin-top:12px;">
<button class="bigbtn" id="undoSet">되돌리기</button>
<button class="bigbtn" id="resetTable">리셋</button>
</div>
</section>

<!-- ================= 1RM ================= -->
<section id="1rm" class="card">
<h2>1RM 계산기</h2>
<label>중량(lb):<input type="number" id="oneRMWeight" value="100"></label>
<label>반복횟수:<input type="number" id="oneRMReps" value="5"></label>
<button class="bigbtn" id="calc1RM">계산</button>
<p id="oneRMResult"></p>
</section>

<!-- ================= RPE ================= -->
<section id="rpe" class="card">
<h2>RPE 계산기</h2>
<label>1RM(lb):<input type="number" id="rpe1RM" value="100"></label>
<label>목표 반복횟수:<input type="number" id="rpeReps" value="5"></label>
<label>RPE(1~10):<input type="number" id="rpeValue" min="1" max="10" value="8"></label>
<button class="bigbtn" id="calcRPE">계산</button>
<p id="rpeResult"></p>
</section>

<!-- ================= Pace ================= -->
<section id="pace" class="card">
<h2>Pace 계산기</h2>
<label>거리(km):<input type="number" id="paceDist" value="5"></label>
<label>시간(mm:ss):<input type="text" id="paceTime" placeholder="mm:ss" value="25:00"></label>
<button class="bigbtn" id="calcPace">계산</button>
<p id="paceResult"></p>
</section>

<!-- ================= Plates ================= -->
<section id="plates" class="card">
<h2>바벨 웜업 계산기</h2>
<div class="row" style="gap:6px;">
<label>바벨 무게(lb):
<select id="barbellWeight">
<option value="45">45</option>
<option value="35">35</option>
<option value="15">15</option>
</select>
</label>
<label>목표 중량(lb):<input type="number" id="plateTarget" value="225"></label>
<label>웜업 퍼센트(%):<input type="text" id="warmupPercents" value="30,60,90"></label>
</div>
<button class="calc-btn" onclick="calculatePlates()">계산하기</button>
<div id="plateResult"></div>
  #plateResult {
  font-size: 12px;
  font-weight: normal;
}
</section>


</div>

<script>
// ================= 탭 전환 =================
const tabs=document.querySelectorAll('.tab');
const sections=document.querySelectorAll('.card');
tabs.forEach(tab=>{
  tab.addEventListener('click',()=>{
    const target=tab.dataset.tab;
    sections.forEach(sec=>sec.classList.remove('active'));
    document.getElementById(target).classList.add('active');
  });
});

// ================= 시간 계산기 =================
const restModeSelect = document.getElementById('restMode');
const restTimeInput = document.getElementById('restTime');
const totalSetsInput = document.getElementById('totalSets');
const tableBody = document.getElementById('timeTable').querySelector('tbody');
const table = document.getElementById('timeTable');
let sets = [];

function parseTime(str){ const p=str.split(':').map(Number); return p[0]*60+p[1]; }
function formatTime(sec){return `${Math.floor(sec/60)}:${(sec%60).toString().padStart(2,'0')}`;}

document.getElementById('generateTable').addEventListener('click', ()=>{
  const n = Number(totalSetsInput.value);
  if(!n || n<1){alert('세트수 입력'); return;}
  tableBody.innerHTML=''; sets=[]; table.style.display='table';
  for(let i=0;i<n;i++){
    const start=(i===0)?0:(sets[i-1].end + sets[i-1].rest);
    sets.push({start:start,end:start,duration:0,rest:0});
    const row = tableBody.insertRow();
    row.insertCell().innerText=i+1;
    row.insertCell().innerText=formatTime(start);
    const endCell=row.insertCell();
    const endInput=document.createElement('input');
    endInput.type='text';
    endInput.dataset.index=i;
    endInput.placeholder='mm:ss';
    endCell.appendChild(endInput);
    row.insertCell().innerText='0:00';
    row.insertCell().innerText='0:00';
  }
  updateInputs();
});

function updateInputs(){
  const inputs = tableBody.querySelectorAll('input');
  inputs.forEach(input=>{
    input.addEventListener('input', (e)=>{
      // 자동 ':' 입력
     let val = e.target.value.replace(/\D/g,''); // 숫자만 남기기
     if(val.length >= 3){
        val = val.slice(0, val.length-2) + ':' + val.slice(-2);
        } else if(val.length >= 2){
        val = val.slice(0, val.length-2) + ':' + val.slice(-2);
        }
       e.target.value = val;

      const i = Number(e.target.dataset.index);
      const sec = parseTime(e.target.value || "0:00");
      sets[i].end = sec;
      sets[i].duration = sec - sets[i].start;

      if(restModeSelect.value==='ratio'){
        sets[i].rest = sets[i].duration;
        restTimeInput.disabled = true;
      } else {
        sets[i].rest = Number(restTimeInput.value)||0;
        restTimeInput.disabled = false;
      }

      if(i<sets.length-1){
        sets[i+1].start = sets[i].end + sets[i].rest;
        tableBody.rows[i+1].cells[1].innerText = formatTime(sets[i+1].start);
      }

      const row = tableBody.rows[i];
      row.cells[3].innerText = formatTime(sets[i].duration);
      row.cells[4].innerText = formatTime(sets[i].rest);
    });
  });
}

// ================= 1RM =================
document.getElementById('calc1RM').addEventListener('click',()=>{
  const w=Number(document.getElementById('oneRMWeight').value);
  const r=Number(document.getElementById('oneRMReps').value);
  const oneRM=w*(1+r/30);
  document.getElementById('oneRMResult').innerText=`1RM: ${oneRM.toFixed(1)} lb`;
});

// ================= RPE =================
document.getElementById('calcRPE').addEventListener('click',()=>{
  const oneRM=Number(document.getElementById('rpe1RM').value);
  const reps=Number(document.getElementById('rpeReps').value);
  const rpe=Number(document.getElementById('rpeValue').value);
  const perc=1-(10-rpe)*0.025; 
  let weight=Math.round(oneRM*perc/5)*5;
  document.getElementById('rpeResult').innerText=`권장 중량: ${weight} lb`;
});

// ================= Pace =================
document.getElementById('calcPace').addEventListener('click',()=>{
  const dist=Number(document.getElementById('paceDist').value);
  const t=document.getElementById('paceTime').value.split(':').map(Number);
  const sec=t[0]*60+t[1];
  const pace=sec/dist;
  document.getElementById('paceResult').innerText=`페이스: ${Math.floor(pace/60)}:${Math.round(pace%60).toString().padStart(2,'0')} /km`;
});

// ================= Plates =================
const barbellSelect=document.getElementById('barbellWeight');
const targetInput=document.getElementById('plateTarget');
const percInput=document.getElementById('warmupPercents');
const resultDiv=document.getElementById('plateResult');
const platesArr=[45,35,25,10,5,2.5];

function calcPlates(total, barWeight){
  let remaining=total-barWeight;
  let out=[];
  for(let p of platesArr){
    let count=Math.floor(remaining/(p*2));
    if(count>0){
      out.push(`${p} x ${count*2}`);
      remaining-=count*2*p;
    }
  }
  return out.join(', ');
}

function updatePlates(){
  const barWeight=Number(barbellSelect.value);
  const target=Number(targetInput.value);
  const percents=percInput.value.split(',').map(s=>Number(s.trim())).filter(v=>v>0 && v<=100);
  if(!target || target<=barWeight){ resultDiv.innerText='목표 중량이 바벨보다 커야 합니다.'; return; }
  let html='';
  percents.forEach(p=>{
    const warmup=Math.round(target*(p/100)/5)*5;
    html+=`<p>${p}% 웜업: ${warmup} lb → 바벨 ${barWeight} + 플레이트: ${calcPlates(warmup, barWeight)}</p>`;
  });
  html+=`<p>목표 중량: ${target} lb → 바벨 ${barWeight} + 플레이트: ${calcPlates(target, barWeight)}</p>`;
  resultDiv.innerHTML=html;
}
[barbellSelect,targetInput,percInput].forEach(el=>el.addEventListener('input',updatePlates));
updatePlates();


</script>
</body>
</html>
